<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="icon" type="image/x-icon" href="/icon.png">
    <style>
        @font-face {
            font-family: newFont;
            src: url(/MontserratAlt1-Light.ttf);
        }
    </style>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@100;600&display=swap" rel="stylesheet">
    <!-- <link rel="stylesheet" href="/output.css"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

</head>

<body class=" bg-white">
    <script defer>
        // const currentURL = window.location.href;
        // console.log(currentURL);
        const URL = "/categoriesUser";
        // fetchWeather: function (city){
		// fetch('http://localhost:5000/info?q='+city)
		// .then((response) => response.json())
		// .then((data) => this.displayWeather(data));
        // }
        

        async function fetchCategories(){
            var res = await fetch(URL);
            var data = await res.json()
            // return data
            var ele = document.getElementById("dropdownBox");
            for (let i = 0; i< data.length; i++){
                const tmp = document.createElement("li");
                tmp.innerHTML = `<a onclick="changeCoontent('${String(data[i])}')" href="#" class="block px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-600 dark:hover:text-white">${data[i]}</a>`
                ele.appendChild(tmp)
            }
        }
        fetchCategories();
    </script>
    <div class="bg-[#03a9fc]/[0.5] rounded-b-lg">
        <h1 class="rounded-b-lg font-['newFont'] text-5xl py-4 border-b-2  border-black">BUDGETAID</h1>
    </div>
    <!-- <script src="./node_modules/flowbite/dist/flowbite.min.js"></script> -->
    <script src="/flowbite.min.js"></script>
    <div class="mt-8 flex justify-center pt-4 pb-4 px-4 sm:px-4">
        
        <div class="border-2 w-full sm:w-2/3 border-black p-8 rounded-lg shadow-[0_0_30px_-5px_rgba(0,0,0,0.3)] ">
            <div>
                <h1 class="text-3xl pt-4 border-black font-semibold p-1 border-b-2 mx-2">Enter New Expense</h1>
            </div>
            <form action="/recordExpense" method="post"></form>
                <div class="p-1 mx-2 block sm:flex justify-around mt-6">
                    <div>
                        <div>
                            <p class="text-lg font-semibold pb-2">Enter Date</p>
                            <input class="outline-none border-b-2 pb-2 mb-2" type="date" name="date" id="date">
                            </div>
                        <div>
                            <p class="text-lg font-semibold pb-2">Choose Category</p>
                            <button name="dropdownnn" id="dropdownDefaultButton" data-dropdown-toggle="dropdown" class="text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:outline-none focus:ring-blue-300 font-medium rounded-lg text-sm px-5 py-2.5 text-center inline-flex items-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800" type="button">Dropdown button <svg class="w-2.5 h-2.5 ml-2.5" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 10 6">
                                <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m1 1 4 4 4-4"/>
                            </svg>
                            </button>
                            <!-- Dropdown menu -->
                            <div id="dropdown" class="z-10 hidden bg-white divide-y divide-gray-100 rounded-lg shadow w-44 dark:bg-gray-700">
                                <ul id="dropdownBox" class="py-2 text-sm text-gray-700 dark:text-gray-200" aria-labelledby="dropdownDefaultButton">
                                    
                                </ul>
                            </div>    

                        </div>
                    </div>
                    <div>
                        <div>
                            <p class="text-lg font-semibold pb-2">Enter Amount</p>
                            <input class="outline-none border-b-2 mb-2 pb-2 ps-2" type="number" name="amount" id="amount" placeholder="amount">
                        </div>
                        <div>
                            <p class="text-lg font-semibold pb-2">Notes</p>
                            <input class="outline-none border-b-2 mb-2 pb-2 ps-2" type="text" name="notes" id="notee" placeholder="note">
                            </div>
                    </div>
                </div>
                <div class="flex justify-center mt-4">
                    <button id="post-btn" name="submit" type="submit" class="focus:outline-none text-white bg-green-700 hover:bg-green-800 focus:ring-4 focus:ring-green-300 font-medium rounded-lg text-sm px-5 py-2.5 mr-2 mb-2 dark:bg-green-600 dark:hover:bg-green-700 dark:focus:ring-green-800">Save Expense</button>
                </div>
            </form>
        </div>
        
    </div>
    <footer class="mb-0 sm:absolute sm:bottom-0  bg-[#004d6b] border-t-2 w-full  text-white">
        <div class=" pt-4 ">
            <div class="">
                <div class="block sm:flex justify-around">
                    <div class="flex justify-center" >
                        <img src="/icon.png" width="100px">
                    </div>
                    <nav >
                        <ul class="mt-0 sm:mt-[25px] flex justify-around">                        
                            <li class="p-2"><a href=#>Home</a></li>
                            <li class="p-2"><a href=#>About</a></li>
                            <li class="p-2"><a href=#>Contact</a></li>
                            <li class="p-2"><a href=#>Privacy Policy</a></li>
                        </ul>
                    </nav>
                    <div>
                            <p class="text-center p-2">Contact Us:</p>
                            <p class="text-center p-2">Email: anuragdaksh77777@gmail.com</p>
                    </div>
                    <div class="mt-0 sm:mt-[25px] flex justify-around">
                        <a class="p-2" href="#" target="_blank"><i class="fab fa-facebook-f"></i></a>
                        <a class="p-2" href="#" target="_blank"><i class="fab fa-twitter"></i></a>
                        <a class="p-2" href="#" target="_blank"><i class="fab fa-instagram"></i></a>
                        <a class="p-2" href="#" target="_blank"><i class="fab fa-linkedin-in"></i></a>
                    </div>
                </div>
                <div class="mb-0 flex justify-center text-white p-2">
                    <p>&copy; 2023 Expense Tracker. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>
    <script>
        function changeCoontent(i) {
            
            var ele = document.getElementById("dropdownDefaultButton");
            // console.log(i);
            ele.innerText = i;
        }
        const button = document.getElementById('post-btn');

        button.addEventListener('click', async _ => {
            // console.log(3232);
        try {     
            const response = await fetch('/recordExpense', {
            method: 'POST',
            body: JSON.stringify({
                date: document.getElementById("date").value,
                amount: document.getElementById("amount").value,
                category: document.getElementById("dropdownDefaultButton").innerText,
                note: document.getElementById("notee").value
            }),
            headers: {
                "Content-type": "application/json; charset=UTF-8"
            }
            })
            alert("Expense Added");
            console.log('Completed!', response.status);
            
        } catch(err) {
            console.error(`Error: ${err}`);
        }
        });
    </script>
</body>
</html>